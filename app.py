# -*- coding: utf-8 -*-

import streamlit as st

# --- ‡∂Ö‡∂¥‡∑ö ‡∂Ø‡∑ê‡∂±‡∑î‡∂∏‡∑ä ‡∂¥‡∂Ø‡∑ä‡∂∞‡∂≠‡∑í‡∂∫ (Knowledge Base v0.1) ---
# ‡∂∏‡∑ö‡∂ö ‡∂≠‡∂∏‡∂∫‡∑í ‡∂Ö‡∂¥‡∑ö ‡∂á‡∂¥‡∑ä ‡∂ë‡∂ö‡∑ö ‡∑Ñ‡∂Ø‡∑Ä‡∂≠. ‡∂Ö‡∂¥‡∑í ‡∂∏‡∑ö‡∂ö ‡∂Ø‡∑í‡∂ú‡∂ß‡∂∏ ‡∂Ω‡∑ú‡∂ö‡∑î ‡∂ö‡∂ª‡∂±‡∑ä‡∂± ‡∂ï‡∂±.
correction_rules = {
    "‡∂∂‡∂Ω‡∑ä‡∂Ω‡∑ú‡∂∫‡∑í ‡∂¥‡∑ñ‡∑É‡∑ú‡∂∫‡∑í ‡∑Ä‡∑Ñ‡∑í‡∂±‡∑Ä‡∑è": "‡∑Ñ‡∑ú‡∂≥‡∂ß‡∂∏ ‡∑Ä‡∑Ñ‡∑í‡∂±‡∑Ä‡∑è",
    "‡∂ö‡∂ö‡∑î‡∂Ω‡∂ö‡∑ä ‡∂ö‡∂©‡∑è‡∂ú‡∂±‡∑ä‡∂±": "‡∂¢‡∂∫ ‡∑Ä‡∑ö‡∑Ä‡∑è!",
    "‡∂∂‡∑ù‡∂Ç‡∂†‡∑í ‡∑Ñ‡∂Ω‡∂±‡∑ä‡∂±": "‡∂á‡∂≠‡∑ä‡∂≠ ‡∂ö‡∑í‡∂∫‡∂±‡∑ä‡∂±",
    "‡∂ã‡∂´‡∑ä‡∂©‡∂∫ ‡∑Ñ‡∂¥‡∂±‡∑ä‡∂±": "‡∂Ö‡∂∏‡∑è‡∂ª‡∑î‡∑Ä‡∑ô‡∂±‡∑ä ‡∑Ñ‡∂ª‡∑í ‡∂∏‡∑ñ‡∂´ ‡∂Ø‡∑ô‡∂±‡∑ä‡∂±",
    "‡∂±‡∑í‡∂Ω‡∑ä ‡∑Ñ‡∂≥‡∂ö ‡∑Ä‡∂ª‡∂ö‡∑ä": "‡∂ö‡∂Ω‡∑è‡∂≠‡∑î‡∂ª‡∂ö‡∑í‡∂±‡∑ä",
    "‡∂î‡∂∂ ‡∂á‡∂´‡∂∫‡∑ö ‡∑Ñ‡∑í‡∑É‡∂ß ‡∂ú‡∑ê‡∑Ñ‡∑î‡∑Ä‡∑è": "‡∂î‡∂∫‡∑è ‡∂ö‡∑í‡∑Ä‡∑ä‡∑Ä‡∑ö ‡∑Ñ‡∂ª‡∑í‡∂∫‡∂ß‡∂∏ ‡∑Ñ‡∂ª‡∑í",
    "‡∂∏‡∂ß ‡∂ö‡∑è‡∂Ω‡∂ú‡∑î‡∂´‡∂∫ ‡∂∫‡∂ß‡∂≠‡∑ö ‡∂Ø‡∑ê‡∂±‡∑ô‡∂±‡∑Ä‡∑è": "‡∂∏‡∂ß ‡∂ß‡∑í‡∂ö‡∂ö‡∑ä ‡∂Ö‡∑É‡∂±‡∑ì‡∂¥‡∂∫‡∑í"
    # ‡∂Ö‡∂Ω‡∑î‡∂≠‡∑ä ‡∂í‡∑Ä‡∑è ‡∂∏‡∑ô‡∂≠‡∂±‡∂ß ‡∂ë‡∂ö‡∂≠‡∑î ‡∂ö‡∂ª‡∂±‡∑ä‡∂±
}

def fix_subtitle_content(content):
    """
    ‡∂ã‡∂¥‡∑É‡∑í‡∂ª‡∑ê‡∑É‡∑í ‡∑Ü‡∂∫‡∑í‡∂Ω‡∑ä ‡∂ë‡∂ö‡∑ö ‡∂Ö‡∂±‡∑ä‡∂≠‡∂ª‡∑ä‡∂ú‡∂≠‡∂∫ ‡∂Ö‡∂ª‡∂ú‡∑ô‡∂±, ‡∂Ö‡∂¥‡∑ö ‡∂ª‡∑ñ‡∂Ω‡∑ä‡∑É‡∑ä ‡∑Ä‡∂Ω‡∂ß ‡∂Ö‡∂±‡∑î‡∑Ä ‡∂±‡∑í‡∑Ä‡∑ê‡∂ª‡∂Ø‡∑í ‡∂ö‡∂ª‡∂± function ‡∂ë‡∂ö.
    """
    lines = content.splitlines()
    corrected_lines = []
    
    for line in lines:
        corrected_line = line
        for bad_phrase, good_phrase in correction_rules.items():
            if bad_phrase in corrected_line:
                corrected_line = corrected_line.replace(bad_phrase, good_phrase)
        corrected_lines.append(corrected_line)
        
    return "\n".join(corrected_lines)

# --- Web App ‡∂ë‡∂ö‡∑ö ‡∂¥‡∑ô‡∂±‡∑î‡∂∏ ‡∑Ñ‡∂Ø‡∂± ‡∂≠‡∑ê‡∂± ---

st.set_page_config(page_title="‡∑É‡∑í‡∂Ç‡∑Ñ‡∂Ω ‡∂ã‡∂¥‡∑É‡∑í‡∂ª‡∑ê‡∑É‡∑í ‡∑É‡∂ö‡∑É‡∂±‡∂∫", page_icon="üìù")

st.title("üìù ‡∑É‡∂ª‡∂Ω ‡∑É‡∑í‡∂Ç‡∑Ñ‡∂Ω ‡∂ã‡∂¥‡∑É‡∑í‡∂ª‡∑ê‡∑É‡∑í ‡∑É‡∂ö‡∑É‡∂±‡∂∫")
st.markdown("Google Translate ‡∂∏‡∂ú‡∑í‡∂±‡∑ä ‡∂¥‡∂ª‡∑í‡∑Ä‡∂ª‡∑ä‡∂≠‡∂±‡∂∫ ‡∂ö‡∑Ö ‡∂ã‡∂¥‡∑É‡∑í‡∂ª‡∑ê‡∑É‡∑í ‡∑Ä‡∂Ω ‡∂á‡∂≠‡∑í ‡∑É‡∑ä‡∑Ä‡∂∑‡∑è‡∑Ä‡∑í‡∂ö ‡∂±‡∑ú‡∑Ä‡∂± ‡∂∫‡∑ô‡∂Ø‡∑î‡∂∏‡∑ä, ‡∑Ä‡∂©‡∑è‡∂≠‡∑ä ‡∂ú‡∑ê‡∂Ω‡∂¥‡∑ô‡∂± ‡∑É‡∂ª‡∂Ω ‡∑É‡∑í‡∂Ç‡∑Ñ‡∂Ω ‡∂∫‡∑ô‡∂Ø‡∑î‡∂∏‡∑ä ‡∂∂‡∑Ä‡∂ß ‡∂¥‡∂≠‡∑ä‡∂ö‡∑í‡∂ª‡∑ì‡∂∏‡∂ß ‡∂∏‡∑ô‡∂∏ ‡∂∫‡∑ô‡∂Ø‡∑î‡∂∏ ‡∂î‡∂∂‡∂ß ‡∂ã‡∂¥‡∂ö‡∑è‡∂ª‡∑ì ‡∑Ä‡∑ö.")

st.subheader("‡∂¥‡∑í‡∂∫‡∑Ä‡∂ª 1: `.srt` ‡∑Ü‡∂∫‡∑í‡∂Ω‡∑ä ‡∂ë‡∂ö Upload ‡∂ö‡∂ª‡∂±‡∑ä‡∂±")
uploaded_file = st.file_uploader("‡∂î‡∂∂‡∂ú‡∑ö .srt ‡∑Ü‡∂∫‡∑í‡∂Ω‡∑ä ‡∂ë‡∂ö ‡∂≠‡∑ù‡∂ª‡∂±‡∑ä‡∂±", type=['srt'])

if uploaded_file is not None:
    st.success(f"'{uploaded_file.name}' ‡∑Ü‡∂∫‡∑í‡∂Ω‡∑ä ‡∂ë‡∂ö ‡∑É‡∑è‡∂ª‡∑ä‡∂Æ‡∂ö‡∑Ä ‡∂Ω‡∑ê‡∂∂‡∑î‡∂±‡∑í.")
    
    original_content = uploaded_file.getvalue().decode("utf-8")
    
    st.subheader("‡∂¥‡∑í‡∂∫‡∑Ä‡∂ª 2: ‡∂ã‡∂¥‡∑É‡∑í‡∂ª‡∑ê‡∑É‡∑í‡∂∫ ‡∂±‡∑í‡∑Ä‡∑ê‡∂ª‡∂Ø‡∑í ‡∂ö‡∂ª‡∂±‡∑ä‡∂±")
    
    if st.button("‚ú® ‡∂ã‡∂¥‡∑É‡∑í‡∂ª‡∑ê‡∑É‡∑í‡∂∫ ‡∂±‡∑í‡∑Ä‡∑ê‡∂ª‡∂Ø‡∑í ‡∂ö‡∂ª‡∂±‡∑ä‡∂±"):
        with st.spinner("‡∂ö‡∂ª‡∑î‡∂´‡∑è‡∂ö‡∂ª ‡∂ª‡∑ê‡∂≥‡∑ì ‡∑É‡∑í‡∂ß‡∑í‡∂±‡∑ä‡∂±..."):
            fixed_content = fix_subtitle_content(original_content)
        
        st.success("‡∂±‡∑í‡∂∫‡∂∏‡∂∫‡∑í! ‡∂î‡∂∂‡∂ú‡∑ö ‡∂ã‡∂¥‡∑É‡∑í‡∂ª‡∑ê‡∑É‡∑í‡∂∫ ‡∂±‡∑í‡∑Ä‡∑ê‡∂ª‡∂Ø‡∑í ‡∂ö‡∂ª ‡∂Ö‡∑Ä‡∑É‡∂±‡∑ä.")
        
        st.subheader("‡∂¥‡∑ä‚Äç‡∂ª‡∂≠‡∑í‡∂µ‡∂Ω‡∂∫: ‡∂±‡∑í‡∑Ä‡∑ê‡∂ª‡∂Ø‡∑í ‡∂ö‡∑Ö ‡∑Ü‡∂∫‡∑í‡∂Ω‡∑ä ‡∂ë‡∂ö Download ‡∂ö‡∂ª‡∂ú‡∂±‡∑ä‡∂±")
        
        st.download_button(
           label="üì• ‡∂±‡∑í‡∑Ä‡∑ê‡∂ª‡∂Ø‡∑í ‡∂ö‡∑Ö ‡∑Ü‡∂∫‡∑í‡∂Ω‡∑ä ‡∂ë‡∂ö ‡∂∏‡∑ô‡∂≠‡∂±‡∑í‡∂±‡∑ä ‡∂∂‡∑è‡∂ú‡∂±‡∑ä‡∂±",
           data=fixed_content,
           file_name=f"fixed_{uploaded_file.name}",
           mime="text/plain"
        )
